<!DOCTYPE html>
<html>

<head>
        <meta http-equiv="content-type" content="text/html; charset=windows-1252">
        <script src="parse_files/jquery.min.js">
        </script>
        <link rel="preconnect" href="https://fonts.googleapis.com/">
        <link rel="preconnect" href="https://fonts.gstatic.com/" crossorigin="">
        <link href="parse_files/css2.css" rel="stylesheet">

        <style>
                .level-0 {
                        margin-left: 0px;
                        margin-top: 5px;
                        margin-bottom: 5px;
                }

                .level-1 {
                        margin-left: 15px;
                        margin-top: 5px;
                        margin-bottom: 5px;
                }

                .level-2 {
                        margin-left: 30px;
                        margin-top: 5px;
                        margin-bottom: 5px;
                }

                .level-3 {
                        margin-left: 45px;
                        margin-top: 5px;
                        margin-bottom: 5px;
                }
        </style>

</head>

<body tab-index="-1">

        <div class="WordSection1">

                <p class="MsoNormal" style="margin-bottom:0in;line-height:normal;text-autospace:
non"><b><span style="font-size:12.0pt;font-family:'Times New Roman',serif"> 813.130
                                        Rights of and consequences for person asked to take test.</span></b><span
                                style='font-size:12.0pt;font-family:"Times New Roman",serif'> This section
                                establishes the requirements for information about rights and consequences for
                                purposes of ORS 813.100 and 813.410. The following apply to the information
                                about rights and consequences:</span></p>

                <p class="MsoNormal" style="margin-bottom:0in;line-height:normal;text-autospace:
none"><span style="font-size:12.0pt;font-family:'Times New Roman',serif"> (1)
                                The information about rights and consequences shall be substantially in the
                                form prepared by the Department of Transportation. The department may establish
                                any form it determines appropriate and convenient.</span></p>

                <p class="MsoNormal" style="margin-bottom:0in;line-height:normal;text-autospace:
none"><span style="font-size:12.0pt;font-family:'Times New Roman',serif"> (2)
                                Except as provided in subsection (3) of this section, the information about
                                rights and consequences shall be substantially as follows:</span></p>

                <p class="MsoNormal" style="margin-bottom:0in;line-height:normal;text-autospace:
none"><span style="font-size:12.0pt;font-family:'Times New Roman',serif"> (a)
                                Driving under the influence of intoxicants is a crime in Oregon, and the person
                                is subject to criminal penalties if a test under ORS 813.100 shows that the
                                person is under the influence of intoxicants. If the person fails a test,
                                evidence of the failure may also be offered against the person.</span></p>

                <p class="MsoNormal" style="margin-bottom:0in;line-height:normal;text-autospace:
none"><span style="font-size:12.0pt;font-family:'Times New Roman',serif"> (b)
                                The person will fail a test under ORS 813.100 for purposes of criminal
                                penalties if the test discloses a blood alcohol content of 0.08 percent or more
                                by weight of alcohol in the blood of the person as shown by chemical analysis
                                of the breath or blood. The person will fail a test for purposes of the
                                Motorist Implied Consent Law if the test discloses a blood alcohol content of:</span>
                </p>

                <p class="MsoNormal" style="margin-bottom:0in;line-height:normal;text-autospace:
none"><span style="font-size:12.0pt;font-family:'Times New Roman',serif"> (A)
                                0.08 percent or more by weight of alcohol in the blood of the person as shown
                                by chemical analysis of the breath or blood if the person was not driving a
                                commercial motor vehicle;</span></p>

                <p class="MsoNormal" style="margin-bottom:0in;line-height:normal;text-autospace:
none"><span style="font-size:12.0pt;font-family:'Times New Roman',serif"> (B)
                                0.04 percent or more by weight of alcohol in the blood of the person as shown
                                by chemical analysis of the breath or blood if the person was driving a
                                commercial motor vehicle; or</span></p>

                <p class="MsoNormal" style="margin-bottom:0in;line-height:normal;text-autospace:
none"><span style="font-size:12.0pt;font-family:'Times New Roman',serif"> (C)
                                Any amount if the person was under 21 years of age.</span></p>

                <p class="MsoNormal" style="margin-bottom:0in;line-height:normal;text-autospace:
none"><span style="font-size:12.0pt;font-family:'Times New Roman',serif"> (c)
                                If the person fails a test under ORS 813.100, the person’s driving privileges
                                will be suspended. The outcome of a criminal charge for driving under the
                                influence of intoxicants will not affect the suspension.</span></p>

                <p class="MsoNormal" style="margin-bottom:0in;line-height:normal;text-autospace:
none"><span style="font-size:12.0pt;font-family:'Times New Roman',serif"> (d)
                                If the person fails a breath test under ORS 813.100 and has an Oregon driver
                                license or permit, the license or permit will be taken immediately and, unless
                                the person does not currently have full valid driving privileges, a temporary
                                driving permit will be issued to the person.</span></p>

                <p class="MsoNormal" style="margin-bottom:0in;line-height:normal;text-autospace:
none"><span style="font-size:12.0pt;font-family:'Times New Roman',serif"> (e)
                                After taking a test under ORS 813.100, the person will have a reasonable
                                opportunity, upon request, for an additional chemical test for blood alcohol
                                content to be performed at the person’s own expense by a qualified individual
                                of the person’s choosing.</span></p>

                <p class="MsoNormal" style="margin-bottom:0in;line-height:normal;text-autospace:
none"><span style="font-size:12.0pt;font-family:'Times New Roman',serif"> (f)
                                The person has a right to a hearing to challenge the validity of the suspension
                                before the suspension becomes effective. The person must make a written request
                                to the department for such a hearing. If the person wins at the hearing, the
                                person’s driving privileges will not be suspended. If the person loses at the
                                hearing, the suspension will remain in effect during any court review of the
                                hearing.</span></p>

                <p class="MsoNormal" style="margin-bottom:0in;line-height:normal;text-autospace:
none"><span style="font-size:12.0pt;font-family:'Times New Roman',serif"> (g)
                                If the person is issued a temporary driving permit under ORS 813.100, the
                                information provided to the person shall include the number of hours before the
                                driving permit will be effective and the number of days the permit will be
                                effective.</span></p>

                <p class="MsoNormal" style="margin-bottom:0in;line-height:normal;text-autospace:
none"><span style="font-size:12.0pt;font-family:'Times New Roman',serif"> (h)
                                The information provided to the person shall include the number of days within
                                which a person must request a hearing under ORS 813.410.</span></p>

                <p class="MsoNormal" style="margin-bottom:0in;line-height:normal;text-autospace:
none"><span style="font-size:12.0pt;font-family:'Times New Roman',serif"> (i)
                                The information provided to the person shall include the number of days within
                                which a hearing under ORS 813.410 will be held.</span></p>

                <p class="MsoNormal" style="margin-bottom:0in;line-height:normal;text-autospace:
none"><span style="font-size:12.0pt;font-family:'Times New Roman',serif"> (j)
                                The person may possibly qualify for a hardship permit in 30 days if the person
                                fails a test, depending on the person’s driving record.</span></p>

                <p class="MsoNormal" style="margin-bottom:0in;line-height:normal;text-autospace:
none"><span style="font-size:12.0pt;font-family:'Times New Roman',serif"> (k)
                                If the person is driving a commercial motor vehicle, and takes a breath or
                                blood test under ORS 813.100 after being informed of the rights and
                                consequences under paragraphs (a) to (j) of this subsection, the following
                                additional information shall be provided:</span></p>

                <p class="MsoNormal" style="margin-bottom:0in;line-height:normal;text-autospace:
none"><span style="font-size:12.0pt;font-family:'Times New Roman',serif"> (A)
                                If the level of alcohol in the person’s blood is 0.04 percent or more by weight
                                of alcohol in the blood of the person as shown by chemical analysis of the
                                breath or blood, the person’s commercial driving privileges or right to apply
                                for commercial driving privileges will be suspended and no hardship permit
                                authorizing the person to drive a commercial motor vehicle will be issued.</span></p>

                <p class="MsoNormal" style="margin-bottom:0in;line-height:normal;text-autospace:
none"><span style="font-size:12.0pt;font-family:'Times New Roman',serif"> (B)
                                The suspension of the person’s commercial driving privileges or right to apply
                                for commercial driving privileges will be for the person’s lifetime if the
                                person takes a breath or blood test and the level of alcohol in the person’s
                                blood is 0.04 percent or more by weight of alcohol in the blood of the person
                                as shown by chemical analysis of the breath or blood and:</span></p>

                <p class="MsoNormal" style="margin-bottom:0in;line-height:normal;text-autospace:
none"><span style="font-size:12.0pt;font-family:'Times New Roman',serif"> (i)
                                The person previously has been convicted of failure to perform the duties of a
                                driver;</span></p>

                <p class="MsoNormal" style="margin-bottom:0in;line-height:normal;text-autospace:
none"><span style="font-size:12.0pt;font-family:'Times New Roman',serif"> (ii)
                                The person previously has been convicted of a crime punishable as a felony and
                                the person was driving a motor vehicle at the time the offense was committed;</span></p>

                <p class="MsoNormal" style="margin-bottom:0in;line-height:normal;text-autospace:
none"><span style="font-size:12.0pt;font-family:'Times New Roman',serif"> (iii)
                                The person previously has been convicted of driving a commercial motor vehicle
                                while the person’s commercial driving privileges or right to apply for
                                commercial driving privileges was suspended or revoked for offenses committed
                                while operating a commercial motor vehicle;</span></p>

                <p class="MsoNormal" style="margin-bottom:0in;line-height:normal;text-autospace:
none"><span style="font-size:12.0pt;font-family:'Times New Roman',serif"> (iv)
                                The person previously has been convicted of any degree of murder, manslaughter
                                or criminally negligent homicide resulting from the operation of a commercial
                                motor vehicle or assault in the first degree resulting from the operation of a
                                commercial motor vehicle;</span></p>

                <p class="MsoNormal" style="margin-bottom:0in;line-height:normal;text-autospace:
none"><span style="font-size:12.0pt;font-family:'Times New Roman',serif"> (v)
                                The person previously has been convicted of driving while under the influence
                                of intoxicants;</span></p>

                <p class="MsoNormal" style="margin-bottom:0in;line-height:normal;text-autospace:
none"><span style="font-size:12.0pt;font-family:'Times New Roman',serif"> (vi)
                                The person’s commercial driving privileges previously have been suspended or
                                revoked for refusal to submit to, or failure of, a breath or blood test under
                                ORS 813.100; or</span></p>

                <p class="MsoNormal" style="margin-bottom:0in;line-height:normal;text-autospace:
none"><span style="font-size:12.0pt;font-family:'Times New Roman',serif"> (vii)
                                The person’s right to apply for commercial driving privileges previously has
                                been suspended or revoked for refusal to submit to, or failure of, a breath or
                                blood test under ORS 813.100 resulting from the operation of a commercial motor
                                vehicle.</span></p>

                <p class="MsoNormal" style="margin-bottom:0in;line-height:normal;text-autospace:
none"><span style="font-size:12.0pt;font-family:'Times New Roman',serif"> (3)
                                A person who refuses to submit to a chemical test after being informed of the
                                rights and consequences in subsection (2) of this section shall be provided
                                additional information, substantially as follows:</span></p>

                <p class="MsoNormal" style="margin-bottom:0in;line-height:normal;text-autospace:
none"><span style="font-size:12.0pt;font-family:'Times New Roman',serif"> (a)
                                If the person refuses to provide consent to a breath or blood test, and is
                                thereafter requested to provide only physical cooperation to submit to a breath
                                or blood test, and the person refuses to physically submit to a test, evidence
                                of that refusal may be offered against the person.</span></p>

                <p class="MsoNormal" style="margin-bottom:0in;line-height:normal;text-autospace:
none"><span style="font-size:12.0pt;font-family:'Times New Roman',serif"> (b)
                                If the person refuses to submit to a test under ORS 813.100, the person’s
                                driving privileges will be suspended. The outcome of a criminal charge for
                                driving under the influence of intoxicants will not affect the suspension. The
                                suspension will be substantially longer if a person refuses a test.</span></p>

                <p class="MsoNormal" style="margin-bottom:0in;line-height:normal;text-autospace:
none"><span style="font-size:12.0pt;font-family:'Times New Roman',serif"> (c)
                                If the person refuses to submit to a breath test under ORS 813.100 and has an
                                Oregon driver license or permit, the license or permit will be taken
                                immediately and, unless the person does not currently have full valid driving
                                privileges, a temporary driving permit will be issued to the person.</span></p>

                <p class="MsoNormal" style="margin-bottom:0in;line-height:normal;text-autospace:
none"><span style="font-size:12.0pt;font-family:'Times New Roman',serif"> (d)
                                If the person refuses to submit to a test under ORS 813.100, the person is not
                                eligible for a hardship permit for at least 90 days, and possibly for three
                                years, depending on the following factors set forth in ORS 813.430:</span></p>

                <p class="MsoNormal" style="margin-bottom:0in;line-height:normal;text-autospace:
none"><span style="font-size:12.0pt;font-family:'Times New Roman',serif"> (A)
                                Whether the person is presently participating in a driving while under the
                                influence of intoxicants diversion program in this state or in any similar
                                alcohol or drug rehabilitation program in this or another jurisdiction; or</span></p>

                <p class="MsoNormal" style="margin-bottom:0in;line-height:normal;text-autospace:
none"><span style="font-size:12.0pt;font-family:'Times New Roman',serif"> (B)
                                Whether within the five years preceding the date of arrest any of the following
                                occurred:</span></p>

                <p class="MsoNormal" style="margin-bottom:0in;line-height:normal;text-autospace:
none"><span style="font-size:12.0pt;font-family:'Times New Roman',serif"> (i)
                                A suspension of the person’s driving privileges under ORS 813.410 or 482.540
                                (1981 Replacement Part) became effective;</span></p>

                <p class="MsoNormal" style="margin-bottom:0in;line-height:normal;text-autospace:
none"><span style="font-size:12.0pt;font-family:'Times New Roman',serif"> (ii)
                                The person was convicted of driving while under the influence of intoxicants in
                                violation of ORS 813.010 or the statutory counterpart to ORS 813.010 in another
                                jurisdiction, as described in ORS 813.430;</span></p>

                <p class="MsoNormal" style="margin-bottom:0in;line-height:normal;text-autospace:
none"><span style="font-size:12.0pt;font-family:'Times New Roman',serif"> (iii)
                                The person was convicted of driving while under the influence of intoxicants in
                                violation of a municipal ordinance in this state or another jurisdiction, as
                                described in ORS 813.430; or</span></p>

                <p class="MsoNormal" style="margin-bottom:0in;line-height:normal;text-autospace:
none"><span style="font-size:12.0pt;font-family:'Times New Roman',serif"> (iv)
                                The person commenced participating in a driving while under the influence of
                                intoxicants diversion program in this state or in any similar alcohol or drug
                                rehabilitation program in this or another jurisdiction, as described in ORS
                                813.430.</span></p>

                <p class="MsoNormal" style="margin-bottom:0in;line-height:normal;text-autospace:
none"><span style="font-size:12.0pt;font-family:'Times New Roman',serif"> (e)
                                If the person refuses to submit to a breath test under ORS 813.100, or refuses
                                to provide a urine sample under ORS 813.131 and 813.132, the person is subject
                                to a fine of at least $500 and not more than $1,000.</span></p>

                <p class="MsoNormal" style="margin-bottom:0in;line-height:normal;text-autospace:
none"><span style="font-size:12.0pt;font-family:'Times New Roman',serif"> (f)
                                The person has a right to a hearing to challenge the validity of the suspension
                                before the suspension becomes effective. The person must make a written request
                                to the department for such a hearing. If the person wins at the hearing, the
                                person’s driving privileges will not be suspended. If the person loses at the
                                hearing, the suspension will remain in effect during any court review of the
                                hearing.</span></p>

                <p class="MsoNormal" style="margin-bottom:0in;line-height:normal;text-autospace:
none"><span style="font-size:12.0pt;font-family:'Times New Roman',serif"> (g)
                                If the person is issued a temporary driving permit under ORS 813.100, the
                                number of hours before the driving permit will be effective and the number of
                                days the permit will be effective.</span></p>

                <p class="MsoNormal" style="margin-bottom:0in;line-height:normal;text-autospace:
none"><span style="font-size:12.0pt;font-family:'Times New Roman',serif"> (h)
                                The number of days within which a person must request a hearing under ORS
                                813.410.</span></p>

                <p class="MsoNormal" style="margin-bottom:0in;line-height:normal;text-autospace:
none"><span style="font-size:12.0pt;font-family:'Times New Roman',serif"> (i)
                                The number of days within which a hearing under ORS 813.410 will be held.</span></p>

                <p class="MsoNormal" style="margin-bottom:0in;line-height:normal;text-autospace:
none"><span style="font-size:12.0pt;font-family:'Times New Roman',serif"> (j)
                                The person may possibly qualify for a hardship permit in 30 days if the person
                                fails a test, depending on the person’s driving record.</span></p>

                <p class="MsoNormal" style="margin-bottom:0in;line-height:normal;text-autospace:
none"><span style="font-size:12.0pt;font-family:'Times New Roman',serif"> (k)
                                If the person is driving a commercial motor vehicle, further information as
                                follows:</span></p>

                <p class="MsoNormal" style="margin-bottom:0in;line-height:normal;text-autospace:
none"><span style="font-size:12.0pt;font-family:'Times New Roman',serif"> (A)
                                If the person refuses to submit to a test under ORS 813.100, the person’s
                                commercial driving privileges or right to apply for commercial driving
                                privileges will be suspended and no hardship permit authorizing the person to
                                drive a commercial motor vehicle will be issued. The suspension will be
                                substantially longer if the person refuses the test.</span></p>

                <p class="MsoNormal" style="margin-bottom:0in;line-height:normal;text-autospace:
none"><span style="font-size:12.0pt;font-family:'Times New Roman',serif"> (B)
                                The suspension of the person’s commercial driving privileges or right to apply
                                for commercial driving privileges will be for the person’s lifetime if the
                                person refuses to submit to a test under ORS 813.100 and:</span></p>

                <p class="MsoNormal" style="margin-bottom:0in;line-height:normal;text-autospace:
none"><span style="font-size:12.0pt;font-family:'Times New Roman',serif"> (i)
                                The person previously has been convicted of failure to perform the duties of a
                                driver;</span></p>

                <p class="MsoNormal" style="margin-bottom:0in;line-height:normal;text-autospace:
none"><span style="font-size:12.0pt;font-family:'Times New Roman',serif"> (ii)
                                The person previously has been convicted of a crime punishable as a felony and
                                the person was driving a motor vehicle at the time the offense was committed;</span></p>

                <p class="MsoNormal" style="margin-bottom:0in;line-height:normal;text-autospace:
none"><span style="font-size:12.0pt;font-family:'Times New Roman',serif"> (iii)
                                The person previously has been convicted of driving a commercial motor vehicle
                                while the person’s commercial driving privileges or right to apply for
                                commercial driving privileges was suspended or revoked for offenses committed
                                while operating a commercial motor vehicle;</span></p>

                <p class="MsoNormal" style="margin-bottom:0in;line-height:normal;text-autospace:
none"><span style="font-size:12.0pt;font-family:'Times New Roman',serif"> (iv)
                                The person previously has been convicted of any degree of murder, manslaughter
                                or criminally negligent homicide resulting from the operation of a commercial
                                motor vehicle or assault in the first degree resulting from the operation of a
                                commercial motor vehicle;</span></p>

                <p class="MsoNormal" style="margin-bottom:0in;line-height:normal;text-autospace:
none"><span style="font-size:12.0pt;font-family:'Times New Roman',serif"> (v)
                                The person previously has been convicted of driving while under the influence
                                of intoxicants;</span></p>

                <p class="MsoNormal" style="margin-bottom:0in;line-height:normal;text-autospace:
none"><span style="font-size:12.0pt;font-family:'Times New Roman',serif"> (vi)
                                The person’s commercial driving privileges previously have been suspended or
                                revoked for refusal to submit to, or failure of, a breath or blood test under
                                ORS 813.100; or</span></p>

                <p class="MsoNormal" style="margin-bottom:0in;line-height:normal;text-autospace:
none"><span style="font-size:12.0pt;font-family:'Times New Roman',serif"> (vii)
                                The person’s right to apply for commercial driving privileges previously has
                                been suspended or revoked for refusal to submit to, or failure of, a breath or
                                blood test under ORS 813.100 resulting from the operation of a commercial motor
                                vehicle.</span></p>

                <p class="MsoNormal" style="margin-bottom:0in;line-height:normal;text-autospace:
none"><span style="font-size:12.0pt;font-family:'Times New Roman',serif"> (4)
                                Nothing in this section prohibits the department from providing additional
                                information concerning rights and consequences that the department considers
                                convenient or appropriate. [1985 c.672 §22; 1987 c.673 §3; 1987 c.801 §11; 1989
                                c.171 §92; 1989 c.636 §43; 1991 c.185 §15; 1991 c.860 §10; 1993 c.305 §4; 1995
                                c.568 §4; 2003 c.814 §3; 2005 c.649 §28; 2009 c.607 §2; 2009 c.614 §2; 2013
                                c.237 §27; 2019 c.475 §2]</span></p>
                <!--
    <p class="MsoNormal" style="margin-bottom:0in;line-height:normal;text-autospace:
    none"><b><span style="font-size:12.0pt;font-family:'Times New Roman',serif"> 813.660
                Service center and manufacturer’s representative certification; fees; rules.</span></b><span style="font-size:12.0pt;font-family:'Times New Roman',serif"> (1) A service
            center or manufacturer’s representative may not operate a service center in
            Oregon unless both the service center and the manufacturer’s representative
            obtain a certificate from the Department of State Police.</span></p>
    
    <p class="MsoNormal" style="margin-bottom:0in;line-height:normal;text-autospace:
    none"><span style="font-size:12.0pt;font-family:'Times New Roman',serif"> (2)
            A service center and a manufacturer’s representative may apply to the department
            for a certificate under this section. The application shall be in such form as
            may be specified by the department.</span></p>
    
    <p class="MsoNormal" style="margin-bottom:0in;line-height:normal;text-autospace:
    none"><span style="font-size:12.0pt;font-family:'Times New Roman',serif"> (3)
            The department may issue a certificate to a manufacturer’s representative if
            the applicant:</span></p>
    
    <p class="MsoNormal" style="margin-bottom:0in;line-height:normal;text-autospace:
    none"><span style="font-size:12.0pt;font-family:'Times New Roman',serif"> (a)
            Meets all of the requirements established by this section and the rules adopted
            by the department;</span></p>
    
    <p class="MsoNormal" style="margin-bottom:0in;line-height:normal;text-autospace:
    none"><span style="font-size:12.0pt;font-family:'Times New Roman',serif"> (b)
            Agrees to provide testimony relating to any aspect of the installation,
            service, monitoring, maintenance, calibration, use, removal or performance of
            the ignition interlock device at any criminal proceeding or administrative
            hearing;</span></p>
    
    <p class="MsoNormal" style="margin-bottom:0in;line-height:normal;text-autospace:
    none"><span style="font-size:12.0pt;font-family:'Times New Roman',serif"> (c)
            Provides service centers statewide, as defined by the department by rule;</span></p>
    
    <p class="MsoNormal" style="margin-bottom:0in;line-height:normal;text-autospace:
    none"><span style="font-size:12.0pt;font-family:'Times New Roman',serif"> (d)
            Provides 24-hour telephone assistance to customers; and</span></p>
    
    <p class="MsoNormal" style="margin-bottom:0in;line-height:normal;text-autospace:
    none"><span style="font-size:12.0pt;font-family:'Times New Roman',serif"> (e)
            Pays all required fees.</span></p>`;
    -->

        </div>



        <script>

                let html = document.querySelector(".WordSection1").innerHTML;

                const gSubRe = /^\(([0-9a-zA-Z]+)\)(.*)/gm;
                const subRe = /^\(([0-9a-zA-Z]+)\)(.*)/;

                const parser = new DOMParser();

                // Tell parse the HTML string into a document.
                const doc = parser.parseFromString(html, "text/html");

                const subs = doc.querySelectorAll("p");

                let sectionNumber = "130";
                const section = document.createElement("div");
                section.setAttribute("id", sectionNumber);

                let subsectionStack = [];
                let lookingFor = ["2"];
                let stackNum = 0;
                let subsectionColText = "";
                // <webc-ors chapter="813" section="130"></webc-ors>

                init();



                function init() {
                        let matches = retrievePTags();

                        const wordDoc = document.getElementsByClassName("WordSection1")[0].innerText;

                        let sectionNumber = "130";
                        const section = document.createElement("div");
                        section.setAttribute("id", sectionNumber);

                        iterateMatches(matches, 0, section, sectionNumber);

                        document.getElementsByClassName('WordSection1')[0].appendChild(section);
                }

                function retrievePTags() {
                        // const subs = doc.querySelectorAll("p");
                        const wordDoc = document.getElementsByClassName("WordSection1")[0].innerText;
                        console.log(wordDoc);

                        let matches = wordDoc.match(gSubRe);

                        return matches;
                }

                function iterateMatches(matches, currentIndex, parent, sectionNumber, lastLevel = '0') {

                        if (currentIndex >= matches.length) {
                                return;
                        }

                        //for (var i = currentIndex; i < matches.length; i++) {
                        // let match = fun(matches, currentIndex);
                        let match = matches[currentIndex].match(subRe);
                        let nextMatch = matches[currentIndex + 1];
                        // 0 should be full text?
                        // 1 is id
                        // 2 is text without subsection
                        console.log(match[1]); // should be id again
                        let id = match[1];
                        let text = match[2];

                        let level = findLevel(id, nextMatch);
                        let willBeChild = level > lastLevel;

                        let element = buildElement(id, text, level, sectionNumber);

                        if (level == lastLevel) {
                                parent.appendChild(element);

                        } else if (level > lastLevel) {
                                parent = parent.lastChild;

                                parent.appendChild(element);

                        } else if (level < lastLevel) {
                                if ((lastLevel - level) == 1) {
                                        parent = parent.parentNode;
                                } else if ((lastLevel - level) == 2) {
                                        parent = parent.parentNode.parentNode;
                                } else if ((lastLevel - level) == 3) {
                                        parent = parent.parentNode.parentNode.parentNode;
                                }

                                parent.appendChild(element);
                        }


                        // identify subsections
                        // build subsection grouping elements

                        iterateMatches(matches, ++currentIndex, parent, sectionNumber, level);

                        //}
                }

                function buildElement(id, text, level, sectionNumber) {
                        let sub = document.createElement("div");
                        sub.setAttribute("id", sectionNumber + "-" + id);
                        sub.setAttribute("class", "level-" + level);

                        let span = document.createElement("span");
                        span.setAttribute("class", "subsection");
                        span.innerText = '(' + id + ')';

                        let theText = document.createTextNode(text);

                        sub.appendChild(span);
                        sub.appendChild(theText);

                        return sub;
                }

                function findLevel(text, nextMatch) {
                        let subNumRe = /^[0-9]+/;
                        let subUpperRe = /^[A-Z]+/;
                        let subRe = /^\(([0-9a-zA-Z]+)\)(.*)/;

                        let nextId;

                        if (nextMatch != null) {
                                nextId = nextMatch.match(subRe)[1];
                        }

                        if (text.match(subNumRe)) {
                                return '0';
                        } else if (!isRomanNumeral(text, nextId) && !text.match(subUpperRe)) {
                                return '1';
                        } else if (text.match(subUpperRe)) {
                                return '2';
                        } else if (isRomanNumeral(text, nextId)) {
                                return '3';
                        }
                }

                // if it returns true - we are good, we can continue to the next subsection
                // if returns false - break out!
                function TestSubsection(text, nextText, len) {
                        let subNumRe = /^[0-9]+/;
                        let subLowRe = /^[a-z]+/;
                        let subUpperRe = /^[A-Z]+/;
                        // text is the subsection we are currently on
                        // stack is the ["2", "b"]

                        // this function is ONLY called when all of the prerequisite subsections have been matched.
                        // ["2", "b"] == ["2", "b"]
                        // add every section afterwards UNTIL we get to the next 'subsection'.
                        // this function is used to test if the next subsection is WITHIN the current subsections.
                        // the way to do this is by testing multiple cases.
                        // - if number.
                        // - if lower case.
                        // - if upper case.
                        // - if lower case AND following roman numerals.
                        // 4 cases.
                        // we decide how far down to look depending on the specified subsections.
                        // if ["2"], look for every case. when a number is hit, break.
                        // if ["2", "b"], look for all uppercase sections and roman sections immediately afterwards.
                        // if we hit a lower case that does not follow roman conventions or a number, break.
                        // if ["2", "b", "C"], look for roman sections. break on anything else.
                        // roman sections are the farthest down we can go. so ["2", "k", "B", "i"] returns 1 section.
                        switch (len) {
                                case (1):
                                        return (!text.match(subNumRe));
                                case (2):
                                        return (isRomanNumeral(text, nextText) || text.match(subUpperRe));
                                case (3):
                                        return (isRomanNumeral(text, nextText));
                                case (4):
                                        return false;
                        }
                }

                function isRomanNumeral(text, nextText) {
                        romanReg = /^[ivx]+/
                        if (nextText == null) {
                                return text.match(romanReg);
                        }
                        return (text.match(romanReg) && (nextText.match(romanReg) || text.length > 1));
                }




        </script>
</body>

</html>